<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EagleGroup</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* ==================== BODY ==================== */
body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:#0051ff; /* asosiy rang oq */
  color:#ffffff;     /* matn qora */
}
.page{display:none;padding:15px;padding-bottom:120px;}
.active{display:block;}
h3{margin-top:0;margin-bottom:15px;}

#productList,
#discountList{
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:15px;
}
/* ==================== PRODUCT / CART / HISTORY ==================== */
.product,.cart-item,.history-item{
  background:#f1f1f100;  /* qo‚Äòshimcha rang kulrang */
  box-shadow: #0a00c5 0px 5px 5px; /* yumshoq soyalar */
  flex-direction: column;
  align-items: center;
  text-align: center;
  padding:15px;
  margin-bottom:15px;
  border-radius:30px;
  display:flex;
  gap:30px;
  align-items:center;
  cursor:pointer;
  border:3px solid #ffffff; /* kulrang border */
}
.product img,.cart-item img,.history-item img{
  width:60%;height:60%;
  border-radius:20px;
  object-fit:cover;
}
button{
  padding:20px;
  border-radius:10px;
  border:none;
  font-weight:600;
  cursor:pointer;
}
.primary{background:#0051ff;color:#fff;} /* asosiy rang qora tugma */
.secondary{background:#ffffff;color:#000;border:1px solid #ccc;} /* qo‚Äòshimcha kulrang */
button:disabled{background:#ccc;color:#888;}
input{
  width:95%;
  align-items: center;
  padding:12px;
  border-radius:10px;
  border:3px solid #fff;
  background:#f9f9f997; /* qo‚Äòshimcha kulrang input */
  color:#ffffff;
  margin-bottom:10px;
}
input::placeholder{
  color:#ffffff;
}
.search{margin-bottom:25px;}

/* ==================== NAVBAR ==================== */
.navbar{
  position:fixed;
  bottom:0;
  width:100%;
  background:#0051ff; /* qo‚Äòshimcha kulrang */
  display:flex;
  justify-content:space-around;
  padding:13px 0;
  border-top:3px solid #ffffff;
}
.navbar button{
  background:none;
  color:#ffffff;
  font-size:18px;
}

/* ==================== MODAL ==================== */
.modal{
  display:none;
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.3);
  justify-content:center;
  align-items:center;
}
.modal-content{
  color: #0051ff;
  background:#ffffff;
  width:90%;
  max-width:360px;
  border-radius:16px;
  padding:15px;
  text-align:center;
  border:1px solid #ccc;
}
.modal-content img{
  width:100%;
  border-radius:12px;
  margin-bottom:15px;
}
.qty-box{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:15px;
  margin-bottom:10px;
}
.qty-box button{
  width:40px;
  height:40px;
  background:#0051ff; /* asosiy rang qora */
  color:#fff;
  border-radius:50%;
}
.close-btn{
  background:#e0e0e0;
  color:#000;
  width:100%;
  margin-top:10px;
}
#orderBtn:disabled{
  background:#ccc;
  color:#888;
  cursor:not-allowed;
}

#orderBtn:not(:disabled){
  background: #fff;
  color: #0051ff;
}
</style>
</head>
<body>

<!-- ==================== MENU ==================== -->
<div id="menu" class="page active">
  <h3 id="menuTitle">–¢–æ–≤–∞—Ä—ã</h3>
<input class="search" type="text" id="searchMenu" placeholder="–ü–æ–∏—Å–∫..." oninput="renderProducts()">
  <div id="productList"></div>
</div>

<!-- ==================== DISCOUNT ==================== -->
<div id="discount" class="page">
  <h3 id="discountTitle">–°–∫–∏–¥–∫–∏</h3>
  <input class="search" type="text" id="searchDiscount" placeholder="–ü–æ–∏—Å–∫..." oninput="renderDiscounts()">
  <div id="discountList"></div>
</div>

<!-- ==================== CART ==================== -->
<div id="cart" class="page">
  <h3 id="cartTitle">–ö–æ—Ä–∑–∏–Ω–∞</h3>
  <input type="text" id="cartName" placeholder="–ò–º—è –§–∞–º–∏–ª–∏—è" oninput="checkOrderBtn()">
  <input type="text" id="cartPhone" placeholder="+998901234567" oninput="checkOrderBtn()">
  <div id="cartItems"></div>
  <h3 id="total"></h3>
  <button id="orderBtn" class="primary" onclick="sendOrder()" disabled>–ó–∞–∫–∞–∑–∞—Ç—å</button>
  <hr style="margin:30px 0;border:1px solid #ffffff;">

<h3>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h3>
<div id="historyListCart"></div>
</div>

<!-- ==================== HISTORY ==================== -->
<div id="history" class="page">
  <h3 id="historyTitle">–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h3>
  <div id="historyList"></div>
</div>

<!-- ==================== PROFILE ==================== -->
<div id="profile" class="page">
  <h3 id="profileTitle">–ü—Ä–æ—Ñ–∏–ª—å</h3>
  <input type="text" id="profileName" placeholder="–ò–º—è –§–∞–º–∏–ª–∏—è">
  <input type="text" id="profilePhone" placeholder="+998901234567">
  <button class="primary" onclick="saveProfile()" style="border: 3px solid #fff; border-radius: 10px; color: #ffffff; padding: 2% 5%;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</div>

<!-- ==================== NAVBAR ==================== -->
<div class="navbar">
  <button onclick="showPage('menu')">–ú–µ–Ω—é</button>
  <button onclick="showPage('discount')">–°–∫–∏–¥–∫–∏</button>
  <button onclick="showPage('cart');loadCart();renderHistory()">–ö–æ—Ä–∑–∏–Ω–∞</button>
  <button onclick="showPage('profile');loadProfile()">–ü—Ä–æ—Ñ–∏–ª—å</button>
</div>

<!-- ==================== MODAL ==================== -->
<div id="productModal" class="modal">
  <div class="modal-content">
    <img id="modalImg">
    <h3 id="modalName"></h3>
    <p id="modalPrice"></p>
    <div id="modalAction"></div>
    <button class="close-btn" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
const botToken="8273671173:AAFhV95y1VN3bEcj1QSbXlSaqrsSYAGnijg";
const chatId="8336275561";
let lang=localStorage.getItem("lang")||"uz";

let products=[
  {name:'8 ELEMENT<br>–®–∞–º–ø—É–Ω—å –º—É–∂—Å–∫–∞—è',price:42000,img:'https://cdn1.ozone.ru/s3/multimedia-1-2/7552305362.jpg'},
  {name:'Fairy Baby 1<br>–ª–∏–ø—É—á–∫–∏ –ø–∞–º–ø–µ—Ä—Å—ã',price:45000,img:'https://avatars.mds.yandex.net/i?id=e6a9e77e279d77465f5e7e0a67c727eb026cb3e3-13219746-images-thumbs&n=13'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg'},
];

let discounts=[
  {name:'Eron<br>–≥–µ–ª—å –¥–ª—è —Å—Ç–∏—Ä–∫–∏ (—Å–∏–Ω–∏–π)',price:85000,img:'https://images.uzum.uz/d2rg88b4eu2h0tmq7hj0/original.jpg',old:95000}
];

let cart=JSON.parse(localStorage.getItem('cart'))||[];
let history=JSON.parse(localStorage.getItem('history'))||[];
let profile=JSON.parse(localStorage.getItem('profile'))||{};
let currentProduct=null;

function setLang(l){lang=l;localStorage.setItem("lang",l);applyLang();}
function applyLang(){
  if(lang==="ru"){
    menuTitle.innerText="–¢–æ–≤–∞—Ä—ã";
    discountTitle.innerText="–°–∫–∏–¥–∫–∏";
    cartTitle.innerText="–ö–æ—Ä–∑–∏–Ω–∞";
    historyTitle.innerText="–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤";
    profileTitle.innerText="–ü—Ä–æ—Ñ–∏–ª—å";
    orderBtn.innerText="–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑";
  }
}

function renderProducts(){
  let q=searchMenu.value.toLowerCase();
  productList.innerHTML="";
  products.filter(p=>p.name.toLowerCase().includes(q))
  .forEach(p=>{
    productList.innerHTML+=`
    <div class='product' onclick='openModal(${JSON.stringify(p)})'>
      <img src='${p.img}'>
      <div>
        <h4>${p.name}</h4>
        <p>${p.price.toLocaleString()} —Å—É–º</p>
      </div>
    </div>`;
  });
}

function renderDiscounts(){
  let q=searchDiscount.value.toLowerCase();
  discountList.innerHTML="";
  discounts.filter(p=>p.name.toLowerCase().includes(q))
  .forEach(p=>{
    discountList.innerHTML+=`
    <div class='product' onclick='openModal(${JSON.stringify(p)})'>
      <img src='${p.img}'>
      <div>
        <h4>${p.name}</h4>
        <p><s>${p.old.toLocaleString()}</s> ‚Üí ${p.price.toLocaleString()} —Å—É–º</p>
      </div>
    </div>`;
  });
}

function openModal(p){
  currentProduct=p;
  modalImg.src=p.img;
  modalName.innerText=p.name;
  modalPrice.innerText=p.price.toLocaleString()+" —Å—É–º";
  updateModalButtons();
  productModal.style.display="flex";
}

function closeModal(){productModal.style.display="none";}

function updateModalButtons(){
  let item=cart.find(i=>i.name===currentProduct.name);
  if(item){
    modalAction.innerHTML=`<div class="qty-box">
      <button onclick="changeQty(-1)">-</button>
      <span>${item.qty}</span>
      <button onclick="changeQty(1)">+</button>
    </div>`;
  }else{
    modalAction.innerHTML=`<button class="primary" onclick="addToCart()">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>`;
  }
}

function addToCart(){
  let item=cart.find(i=>i.name===currentProduct.name);
  if(item)item.qty++;
  else cart.push({...currentProduct,qty:1});
  localStorage.setItem("cart",JSON.stringify(cart));
  updateModalButtons();
  loadCart();
}

function changeQty(v){
  let item=cart.find(i=>i.name===currentProduct.name);
  if(!item) return;
  item.qty+=v;
  if(item.qty<=0) cart=cart.filter(i=>i.name!==currentProduct.name);
  localStorage.setItem("cart",JSON.stringify(cart));
  updateModalButtons();
  loadCart();
}

function loadCart(){
  cartItems.innerHTML="";
  let total=0;
  cart.forEach(i=>{
    total+=i.price*i.qty;
    cartItems.innerHTML+=`
    <div class="cart-item">
      <div style="flex:1">${i.name} x${i.qty}</div>
      <div>
        <button class="secondary" onclick="adjustCart('${i.name}',-1)">-</button>
        <button class="secondary" onclick="adjustCart('${i.name}',1)">+</button>
      </div>
    </div>`;
  });
  totalElem=document.getElementById("total");
  totalElem.innerText="–û–±—â: "+total.toLocaleString()+" —Å—É–º";
  if(profile.name) cartName.value=profile.name;
  if(profile.phone) cartPhone.value=profile.phone;
  checkOrderBtn();
}

function adjustCart(name,v){
  let item=cart.find(i=>i.name===name);
  if(!item) return;
  item.qty+=v;
  if(item.qty<=0) cart=cart.filter(i=>i.name!==name);
  localStorage.setItem("cart",JSON.stringify(cart));
  loadCart();
  if(currentProduct && currentProduct.name===name) updateModalButtons();
}

function checkOrderBtn(){
  let name=cartName.value.trim();
  let phone=cartPhone.value.trim();
  orderBtn.disabled=!(name && phone && cart.length>0);
}

function sendOrder(){
  let name=cartName.value.trim();
  let phone=cartPhone.value.trim();
  if(!name || !phone || cart.length===0) return;
  profile={name,phone};
  localStorage.setItem("profile",JSON.stringify(profile));
  let total=0;
  let message="üõí –ù–æ–≤—ã–π –ó–∞–∫–∞–∑\n\nüë§ –ò–º—è: "+name+"\nüìû –¢–µ–ª–µ—Ñ–æ–Ω: "+phone+"\n\nüì¶ –¢–æ–≤–∞—Ä—ã:\n";
  cart.forEach(i=>{
    message+=i.name+" x"+i.qty+" - "+(i.price*i.qty).toLocaleString()+" —Å—É–º\n";
    total+=i.price*i.qty;
  });
  message+="\nüí∞ Jami: "+total.toLocaleString()+" —Å—É–º";
  fetch(`https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`)
  .then(res=>{
    if(res.ok){
      alert("Buyurtma yuborildi!");
      history.push({name,phone,items:[...cart],total});
      localStorage.setItem("history",JSON.stringify(history));
      cart=[];
      localStorage.setItem("cart",JSON.stringify(cart));
      loadCart();
    }else alert("Telegramga yuborishda xatolik!");
  });
}

function renderHistory(){
  historyList.innerHTML="";
  if(document.getElementById("historyListCart")){
    historyListCart.innerHTML="";
  }

  history.forEach(h=>{
    let itemsText=h.items.map(it=>it.name+" x"+it.qty).join(", ");

    let html=`
    <div class="history-item">
      <div style="flex:1">${h.name} | ${h.phone}</div>
      <div>${itemsText} | –û–±—â: ${h.total.toLocaleString()} —Å—É–º</div>
    </div>`;

    historyList.innerHTML+=html;

    if(document.getElementById("historyListCart")){
      historyListCart.innerHTML+=html;
    }
  });
}

function saveProfile(){
  profile={name:profileName.value,phone:profilePhone.value};
  localStorage.setItem("profile",JSON.stringify(profile));
  alert(lang==="ru"?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!":"Saqlandi");
}

function loadProfile(){
  profileName.value=profile.name||"";
  profilePhone.value=profile.phone||"";
}

function showPage(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

window.onload=function(){
  renderProducts();
  renderDiscounts();
  applyLang();
  loadProfile();
};
</script>
</body>

</html>

